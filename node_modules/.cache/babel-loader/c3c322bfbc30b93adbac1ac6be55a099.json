{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _toPropertyKey from \"@babel/runtime/helpers/toPropertyKey\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport sleep from 'sleep-promise';\nimport useIsMountedRef from 'use-is-mounted-ref';\nimport { defaultShouldLoadMore } from './defaultShouldLoadMore';\nimport { defaultReduceOptions } from './defaultReduceOptions';\nvar errorText = '[react-select-async-paginate] response of \"loadOptions\" should be an object with \"options\" prop, which contains array of options.';\nexport var validateResponse = function validateResponse(console, response) {\n  if (!response) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n\n  if (!Array.isArray(response.options)) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n};\nexport var getInitialOptionsCache = function getInitialOptionsCache(_ref) {\n  var options = _ref.options,\n      defaultOptions = _ref.defaultOptions,\n      additional = _ref.additional,\n      defaultAdditional = _ref.defaultAdditional;\n  var initialOptions = defaultOptions === true ? null : defaultOptions instanceof Array ? defaultOptions : options;\n\n  if (initialOptions) {\n    return {\n      '': {\n        isFirstLoad: false,\n        isLoading: false,\n        options: initialOptions,\n        hasMore: true,\n        additional: defaultAdditional || additional\n      }\n    };\n  }\n\n  return {};\n};\nexport var getInitialCache = function getInitialCache(params) {\n  return {\n    isFirstLoad: true,\n    options: [],\n    hasMore: true,\n    isLoading: false,\n    additional: params.additional\n  };\n};\nexport var requestOptions = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(caller, paramsRef, optionsCacheRef, debounceTimeout, sleepParam, setOptionsCache, validateResponseParam, reduceOptions) {\n    var currentInputValue, isCacheEmpty, currentOptions, newInputValue, response, hasError, loadOptions, _response, options, hasMore, newAdditional;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            currentInputValue = paramsRef.current.inputValue;\n            isCacheEmpty = !optionsCacheRef.current[currentInputValue];\n            currentOptions = isCacheEmpty ? getInitialCache(paramsRef.current) : optionsCacheRef.current[currentInputValue];\n\n            if (!(currentOptions.isLoading || !currentOptions.hasMore)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 5:\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: true\n              })));\n            });\n\n            if (!(debounceTimeout > 0 && caller === 'input-change')) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 9;\n            return sleepParam(debounceTimeout);\n\n          case 9:\n            newInputValue = paramsRef.current.inputValue;\n\n            if (!(currentInputValue !== newInputValue)) {\n              _context.next = 13;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              if (isCacheEmpty) {\n                var itemForDelete = prevOptionsCache[currentInputValue],\n                    restCache = _objectWithoutProperties(prevOptionsCache, [currentInputValue].map(_toPropertyKey));\n\n                return restCache;\n              }\n\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 13:\n            _context.prev = 13;\n            loadOptions = paramsRef.current.loadOptions;\n            _context.next = 17;\n            return loadOptions(currentInputValue, currentOptions.options, currentOptions.additional);\n\n          case 17:\n            response = _context.sent;\n            hasError = false;\n            _context.next = 24;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](13);\n            hasError = true;\n\n          case 24:\n            if (!hasError) {\n              _context.next = 27;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 27:\n            validateResponseParam(console, response);\n            _response = response, options = _response.options, hasMore = _response.hasMore; // eslint-disable-next-line no-prototype-builtins\n\n            newAdditional = response.hasOwnProperty('additional') ? response.additional : currentOptions.additional;\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                options: reduceOptions(currentOptions.options, options, newAdditional),\n                hasMore: !!hasMore,\n                isLoading: false,\n                isFirstLoad: false,\n                additional: newAdditional\n              })));\n            });\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[13, 21]]);\n  }));\n\n  return function requestOptions(_x, _x2, _x3, _x4, _x5, _x6, _x7, _x8) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var increaseStateId = function increaseStateId(prevStateId) {\n  return prevStateId + 1;\n};\nexport var useAsyncPaginateBasePure = function useAsyncPaginateBasePure(useRefParam, useStateParam, useEffectParam, useCallbackParam, validateResponseParam, getInitialOptionsCacheParam, requestOptionsParam, params) {\n  var deps = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : [];\n  var defaultOptions = params.defaultOptions,\n      _params$loadOptionsOn = params.loadOptionsOnMenuOpen,\n      loadOptionsOnMenuOpen = _params$loadOptionsOn === void 0 ? true : _params$loadOptionsOn,\n      _params$debounceTimeo = params.debounceTimeout,\n      debounceTimeout = _params$debounceTimeo === void 0 ? 0 : _params$debounceTimeo,\n      inputValue = params.inputValue,\n      menuIsOpen = params.menuIsOpen,\n      _params$filterOption = params.filterOption,\n      filterOption = _params$filterOption === void 0 ? null : _params$filterOption,\n      _params$reduceOptions = params.reduceOptions,\n      reduceOptions = _params$reduceOptions === void 0 ? defaultReduceOptions : _params$reduceOptions,\n      _params$shouldLoadMor = params.shouldLoadMore,\n      shouldLoadMore = _params$shouldLoadMor === void 0 ? defaultShouldLoadMore : _params$shouldLoadMor;\n  var isMountedRef = useIsMountedRef();\n  var isInitRef = useRefParam(true);\n  var paramsRef = useRefParam(params);\n  paramsRef.current = params;\n  var setStateId = useStateParam(0)[1];\n  var optionsCacheRef = useRefParam(null);\n\n  if (optionsCacheRef.current === null) {\n    optionsCacheRef.current = getInitialOptionsCacheParam(params);\n  }\n\n  var callRequestOptions = useCallbackParam(function (caller) {\n    requestOptionsParam(caller, paramsRef, optionsCacheRef, debounceTimeout, sleep, function (reduceState) {\n      optionsCacheRef.current = reduceState(optionsCacheRef.current);\n\n      if (isMountedRef.current) {\n        setStateId(increaseStateId);\n      }\n    }, validateResponseParam, reduceOptions);\n  }, [debounceTimeout]);\n  var handleScrolledToBottom = useCallbackParam(function () {\n    var currentInputValue = paramsRef.current.inputValue;\n    var currentOptions = optionsCacheRef.current[currentInputValue];\n\n    if (currentOptions) {\n      callRequestOptions('menu-scroll');\n    }\n  }, [callRequestOptions]);\n  useEffectParam(function () {\n    if (isInitRef.current) {\n      isInitRef.current = false;\n    } else {\n      optionsCacheRef.current = {};\n      setStateId(increaseStateId);\n    }\n\n    if (defaultOptions === true) {\n      callRequestOptions('autoload');\n    }\n  }, deps);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[inputValue]) {\n      callRequestOptions('input-change');\n    }\n  }, [inputValue]);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[''] && loadOptionsOnMenuOpen) {\n      callRequestOptions('menu-toggle');\n    }\n  }, [menuIsOpen]);\n  var currentOptions = optionsCacheRef.current[inputValue] || getInitialCache(params);\n  return {\n    handleScrolledToBottom: handleScrolledToBottom,\n    shouldLoadMore: shouldLoadMore,\n    filterOption: filterOption,\n    isLoading: currentOptions.isLoading,\n    isFirstLoad: currentOptions.isFirstLoad,\n    options: currentOptions.options\n  };\n};\nexport var useAsyncPaginateBase = function useAsyncPaginateBase(params) {\n  var deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return useAsyncPaginateBasePure(useRef, useState, useEffect, useCallback, validateResponse, getInitialOptionsCache, requestOptions, params, deps);\n};","map":{"version":3,"sources":["C:/apps/weather/node_modules/react-select-async-paginate/es/useAsyncPaginateBase.js"],"names":["_objectWithoutProperties","_toPropertyKey","_defineProperty","_objectSpread","_asyncToGenerator","_regeneratorRuntime","useState","useEffect","useRef","useCallback","sleep","useIsMountedRef","defaultShouldLoadMore","defaultReduceOptions","errorText","validateResponse","console","response","error","Error","Array","isArray","options","getInitialOptionsCache","_ref","defaultOptions","additional","defaultAdditional","initialOptions","isFirstLoad","isLoading","hasMore","getInitialCache","params","requestOptions","_ref2","mark","_callee","caller","paramsRef","optionsCacheRef","debounceTimeout","sleepParam","setOptionsCache","validateResponseParam","reduceOptions","currentInputValue","isCacheEmpty","currentOptions","newInputValue","hasError","loadOptions","_response","newAdditional","wrap","_callee$","_context","prev","next","current","inputValue","abrupt","prevOptionsCache","itemForDelete","restCache","map","sent","t0","hasOwnProperty","stop","_x","_x2","_x3","_x4","_x5","_x6","_x7","_x8","apply","arguments","increaseStateId","prevStateId","useAsyncPaginateBasePure","useRefParam","useStateParam","useEffectParam","useCallbackParam","getInitialOptionsCacheParam","requestOptionsParam","deps","length","undefined","_params$loadOptionsOn","loadOptionsOnMenuOpen","_params$debounceTimeo","menuIsOpen","_params$filterOption","filterOption","_params$reduceOptions","_params$shouldLoadMor","shouldLoadMore","isMountedRef","isInitRef","setStateId","callRequestOptions","reduceState","handleScrolledToBottom","useAsyncPaginateBase"],"mappings":"AAAA,OAAOA,wBAAP,MAAqC,gDAArC;AACA,OAAOC,cAAP,MAA2B,sCAA3B;AACA,OAAOC,eAAP,MAA4B,uCAA5B;AACA,OAAOC,aAAP,MAA0B,sCAA1B;AACA,OAAOC,iBAAP,MAA8B,yCAA9B;AACA,OAAOC,mBAAP,MAAgC,4BAAhC;AACA,SAASC,QAAT,EAAmBC,SAAnB,EAA8BC,MAA9B,EAAsCC,WAAtC,QAAyD,OAAzD;AACA,OAAOC,KAAP,MAAkB,eAAlB;AACA,OAAOC,eAAP,MAA4B,oBAA5B;AACA,SAASC,qBAAT,QAAsC,yBAAtC;AACA,SAASC,oBAAT,QAAqC,wBAArC;AACA,IAAIC,SAAS,GAAG,mIAAhB;AACA,OAAO,IAAIC,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,OAA1B,EAAmCC,QAAnC,EAA6C;AACzE,MAAI,CAACA,QAAL,EAAe;AACbD,IAAAA,OAAO,CAACE,KAAR,CAAcJ,SAAd,EAAyB,WAAzB,EAAsCG,QAAtC;AACA,UAAM,IAAIE,KAAJ,CAAUL,SAAV,CAAN;AACD;;AAED,MAAI,CAACM,KAAK,CAACC,OAAN,CAAcJ,QAAQ,CAACK,OAAvB,CAAL,EAAsC;AACpCN,IAAAA,OAAO,CAACE,KAAR,CAAcJ,SAAd,EAAyB,WAAzB,EAAsCG,QAAtC;AACA,UAAM,IAAIE,KAAJ,CAAUL,SAAV,CAAN;AACD;AACF,CAVM;AAWP,OAAO,IAAIS,sBAAsB,GAAG,SAASA,sBAAT,CAAgCC,IAAhC,EAAsC;AACxE,MAAIF,OAAO,GAAGE,IAAI,CAACF,OAAnB;AAAA,MACIG,cAAc,GAAGD,IAAI,CAACC,cAD1B;AAAA,MAEIC,UAAU,GAAGF,IAAI,CAACE,UAFtB;AAAA,MAGIC,iBAAiB,GAAGH,IAAI,CAACG,iBAH7B;AAIA,MAAIC,cAAc,GAAGH,cAAc,KAAK,IAAnB,GAA0B,IAA1B,GAAiCA,cAAc,YAAYL,KAA1B,GAAkCK,cAAlC,GAAmDH,OAAzG;;AAEA,MAAIM,cAAJ,EAAoB;AAClB,WAAO;AACL,UAAI;AACFC,QAAAA,WAAW,EAAE,KADX;AAEFC,QAAAA,SAAS,EAAE,KAFT;AAGFR,QAAAA,OAAO,EAAEM,cAHP;AAIFG,QAAAA,OAAO,EAAE,IAJP;AAKFL,QAAAA,UAAU,EAAEC,iBAAiB,IAAID;AAL/B;AADC,KAAP;AASD;;AAED,SAAO,EAAP;AACD,CApBM;AAqBP,OAAO,IAAIM,eAAe,GAAG,SAASA,eAAT,CAAyBC,MAAzB,EAAiC;AAC5D,SAAO;AACLJ,IAAAA,WAAW,EAAE,IADR;AAELP,IAAAA,OAAO,EAAE,EAFJ;AAGLS,IAAAA,OAAO,EAAE,IAHJ;AAILD,IAAAA,SAAS,EAAE,KAJN;AAKLJ,IAAAA,UAAU,EAAEO,MAAM,CAACP;AALd,GAAP;AAOD,CARM;AASP,OAAO,IAAIQ,cAAc,GAAG,aAAa,YAAY;AACnD,MAAIC,KAAK,GAAG/B,iBAAiB,EAAE,aAAaC,mBAAmB,CAAC+B,IAApB,CAAyB,SAASC,OAAT,CAAiBC,MAAjB,EAAyBC,SAAzB,EAAoCC,eAApC,EAAqDC,eAArD,EAAsEC,UAAtE,EAAkFC,eAAlF,EAAmGC,qBAAnG,EAA0HC,aAA1H,EAAyI;AAC5M,QAAIC,iBAAJ,EAAuBC,YAAvB,EAAqCC,cAArC,EAAqDC,aAArD,EAAoEhC,QAApE,EAA8EiC,QAA9E,EAAwFC,WAAxF,EAAqGC,SAArG,EAAgH9B,OAAhH,EAAyHS,OAAzH,EAAkIsB,aAAlI;;AAEA,WAAOhD,mBAAmB,CAACiD,IAApB,CAAyB,SAASC,QAAT,CAAkBC,QAAlB,EAA4B;AAC1D,aAAO,CAAP,EAAU;AACR,gBAAQA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACE,IAAjC;AACE,eAAK,CAAL;AACEZ,YAAAA,iBAAiB,GAAGP,SAAS,CAACoB,OAAV,CAAkBC,UAAtC;AACAb,YAAAA,YAAY,GAAG,CAACP,eAAe,CAACmB,OAAhB,CAAwBb,iBAAxB,CAAhB;AACAE,YAAAA,cAAc,GAAGD,YAAY,GAAGf,eAAe,CAACO,SAAS,CAACoB,OAAX,CAAlB,GAAwCnB,eAAe,CAACmB,OAAhB,CAAwBb,iBAAxB,CAArE;;AAEA,gBAAI,EAAEE,cAAc,CAAClB,SAAf,IAA4B,CAACkB,cAAc,CAACjB,OAA9C,CAAJ,EAA4D;AAC1DyB,cAAAA,QAAQ,CAACE,IAAT,GAAgB,CAAhB;AACA;AACD;;AAED,mBAAOF,QAAQ,CAACK,MAAT,CAAgB,QAAhB,CAAP;;AAEF,eAAK,CAAL;AACElB,YAAAA,eAAe,CAAC,UAAUmB,gBAAV,EAA4B;AAC1C,qBAAO3D,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK2D,gBAAL,CAAd,EAAsC,EAAtC,EAA0C5D,eAAe,CAAC,EAAD,EAAK4C,iBAAL,EAAwB3C,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK6C,cAAL,CAAd,EAAoC,EAApC,EAAwC;AACxJlB,gBAAAA,SAAS,EAAE;AAD6I,eAAxC,CAArC,CAAzD,CAApB;AAGD,aAJc,CAAf;;AAMA,gBAAI,EAAEW,eAAe,GAAG,CAAlB,IAAuBH,MAAM,KAAK,cAApC,CAAJ,EAAyD;AACvDkB,cAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACD;;AAEDF,YAAAA,QAAQ,CAACE,IAAT,GAAgB,CAAhB;AACA,mBAAOhB,UAAU,CAACD,eAAD,CAAjB;;AAEF,eAAK,CAAL;AACEQ,YAAAA,aAAa,GAAGV,SAAS,CAACoB,OAAV,CAAkBC,UAAlC;;AAEA,gBAAI,EAAEd,iBAAiB,KAAKG,aAAxB,CAAJ,EAA4C;AAC1CO,cAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACD;;AAEDf,YAAAA,eAAe,CAAC,UAAUmB,gBAAV,EAA4B;AAC1C,kBAAIf,YAAJ,EAAkB;AAChB,oBAAIgB,aAAa,GAAGD,gBAAgB,CAAChB,iBAAD,CAApC;AAAA,oBACIkB,SAAS,GAAGhE,wBAAwB,CAAC8D,gBAAD,EAAmB,CAAChB,iBAAD,EAAoBmB,GAApB,CAAwBhE,cAAxB,CAAnB,CADxC;;AAGA,uBAAO+D,SAAP;AACD;;AAED,qBAAO7D,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK2D,gBAAL,CAAd,EAAsC,EAAtC,EAA0C5D,eAAe,CAAC,EAAD,EAAK4C,iBAAL,EAAwB3C,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK6C,cAAL,CAAd,EAAoC,EAApC,EAAwC;AACxJlB,gBAAAA,SAAS,EAAE;AAD6I,eAAxC,CAArC,CAAzD,CAApB;AAGD,aAXc,CAAf;AAYA,mBAAO0B,QAAQ,CAACK,MAAT,CAAgB,QAAhB,CAAP;;AAEF,eAAK,EAAL;AACEL,YAAAA,QAAQ,CAACC,IAAT,GAAgB,EAAhB;AACAN,YAAAA,WAAW,GAAGZ,SAAS,CAACoB,OAAV,CAAkBR,WAAhC;AACAK,YAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,mBAAOP,WAAW,CAACL,iBAAD,EAAoBE,cAAc,CAAC1B,OAAnC,EAA4C0B,cAAc,CAACtB,UAA3D,CAAlB;;AAEF,eAAK,EAAL;AACET,YAAAA,QAAQ,GAAGuC,QAAQ,CAACU,IAApB;AACAhB,YAAAA,QAAQ,GAAG,KAAX;AACAM,YAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;;AAEF,eAAK,EAAL;AACEF,YAAAA,QAAQ,CAACC,IAAT,GAAgB,EAAhB;AACAD,YAAAA,QAAQ,CAACW,EAAT,GAAcX,QAAQ,CAAC,OAAD,CAAR,CAAkB,EAAlB,CAAd;AACAN,YAAAA,QAAQ,GAAG,IAAX;;AAEF,eAAK,EAAL;AACE,gBAAI,CAACA,QAAL,EAAe;AACbM,cAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACD;;AAEDf,YAAAA,eAAe,CAAC,UAAUmB,gBAAV,EAA4B;AAC1C,qBAAO3D,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK2D,gBAAL,CAAd,EAAsC,EAAtC,EAA0C5D,eAAe,CAAC,EAAD,EAAK4C,iBAAL,EAAwB3C,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK6C,cAAL,CAAd,EAAoC,EAApC,EAAwC;AACxJlB,gBAAAA,SAAS,EAAE;AAD6I,eAAxC,CAArC,CAAzD,CAApB;AAGD,aAJc,CAAf;AAKA,mBAAO0B,QAAQ,CAACK,MAAT,CAAgB,QAAhB,CAAP;;AAEF,eAAK,EAAL;AACEjB,YAAAA,qBAAqB,CAAC5B,OAAD,EAAUC,QAAV,CAArB;AACAmC,YAAAA,SAAS,GAAGnC,QAAZ,EAAsBK,OAAO,GAAG8B,SAAS,CAAC9B,OAA1C,EAAmDS,OAAO,GAAGqB,SAAS,CAACrB,OAAvE,CAFF,CAEkF;;AAEhFsB,YAAAA,aAAa,GAAGpC,QAAQ,CAACmD,cAAT,CAAwB,YAAxB,IAAwCnD,QAAQ,CAACS,UAAjD,GAA8DsB,cAAc,CAACtB,UAA7F;AACAiB,YAAAA,eAAe,CAAC,UAAUmB,gBAAV,EAA4B;AAC1C,qBAAO3D,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK2D,gBAAL,CAAd,EAAsC,EAAtC,EAA0C5D,eAAe,CAAC,EAAD,EAAK4C,iBAAL,EAAwB3C,aAAa,CAACA,aAAa,CAAC,EAAD,EAAK6C,cAAL,CAAd,EAAoC,EAApC,EAAwC;AACxJ1B,gBAAAA,OAAO,EAAEuB,aAAa,CAACG,cAAc,CAAC1B,OAAhB,EAAyBA,OAAzB,EAAkC+B,aAAlC,CADkI;AAExJtB,gBAAAA,OAAO,EAAE,CAAC,CAACA,OAF6I;AAGxJD,gBAAAA,SAAS,EAAE,KAH6I;AAIxJD,gBAAAA,WAAW,EAAE,KAJ2I;AAKxJH,gBAAAA,UAAU,EAAE2B;AAL4I,eAAxC,CAArC,CAAzD,CAApB;AAOD,aARc,CAAf;;AAUF,eAAK,EAAL;AACA,eAAK,KAAL;AACE,mBAAOG,QAAQ,CAACa,IAAT,EAAP;AAjGJ;AAmGD;AACF,KAtGM,EAsGJhC,OAtGI,EAsGK,IAtGL,EAsGW,CAAC,CAAC,EAAD,EAAK,EAAL,CAAD,CAtGX,CAAP;AAuGD,GA1G2C,CAAf,CAA7B;;AA4GA,SAAO,SAASH,cAAT,CAAwBoC,EAAxB,EAA4BC,GAA5B,EAAiCC,GAAjC,EAAsCC,GAAtC,EAA2CC,GAA3C,EAAgDC,GAAhD,EAAqDC,GAArD,EAA0DC,GAA1D,EAA+D;AACpE,WAAO1C,KAAK,CAAC2C,KAAN,CAAY,IAAZ,EAAkBC,SAAlB,CAAP;AACD,GAFD;AAGD,CAhHwC,EAAlC;AAiHP,OAAO,IAAIC,eAAe,GAAG,SAASA,eAAT,CAAyBC,WAAzB,EAAsC;AACjE,SAAOA,WAAW,GAAG,CAArB;AACD,CAFM;AAGP,OAAO,IAAIC,wBAAwB,GAAG,SAASA,wBAAT,CAAkCC,WAAlC,EAA+CC,aAA/C,EAA8DC,cAA9D,EAA8EC,gBAA9E,EAAgG1C,qBAAhG,EAAuH2C,2BAAvH,EAAoJC,mBAApJ,EAAyKvD,MAAzK,EAAiL;AACrN,MAAIwD,IAAI,GAAGV,SAAS,CAACW,MAAV,GAAmB,CAAnB,IAAwBX,SAAS,CAAC,CAAD,CAAT,KAAiBY,SAAzC,GAAqDZ,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;AACA,MAAItD,cAAc,GAAGQ,MAAM,CAACR,cAA5B;AAAA,MACImE,qBAAqB,GAAG3D,MAAM,CAAC4D,qBADnC;AAAA,MAEIA,qBAAqB,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,IAAnC,GAA0CA,qBAFtE;AAAA,MAGIE,qBAAqB,GAAG7D,MAAM,CAACQ,eAHnC;AAAA,MAIIA,eAAe,GAAGqD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,CAAnC,GAAuCA,qBAJ7D;AAAA,MAKIlC,UAAU,GAAG3B,MAAM,CAAC2B,UALxB;AAAA,MAMImC,UAAU,GAAG9D,MAAM,CAAC8D,UANxB;AAAA,MAOIC,oBAAoB,GAAG/D,MAAM,CAACgE,YAPlC;AAAA,MAQIA,YAAY,GAAGD,oBAAoB,KAAK,KAAK,CAA9B,GAAkC,IAAlC,GAAyCA,oBAR5D;AAAA,MASIE,qBAAqB,GAAGjE,MAAM,CAACY,aATnC;AAAA,MAUIA,aAAa,GAAGqD,qBAAqB,KAAK,KAAK,CAA/B,GAAmCrF,oBAAnC,GAA0DqF,qBAV9E;AAAA,MAWIC,qBAAqB,GAAGlE,MAAM,CAACmE,cAXnC;AAAA,MAYIA,cAAc,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmCvF,qBAAnC,GAA2DuF,qBAZhF;AAaA,MAAIE,YAAY,GAAG1F,eAAe,EAAlC;AACA,MAAI2F,SAAS,GAAGnB,WAAW,CAAC,IAAD,CAA3B;AACA,MAAI5C,SAAS,GAAG4C,WAAW,CAAClD,MAAD,CAA3B;AACAM,EAAAA,SAAS,CAACoB,OAAV,GAAoB1B,MAApB;AACA,MAAIsE,UAAU,GAAGnB,aAAa,CAAC,CAAD,CAAb,CAAiB,CAAjB,CAAjB;AACA,MAAI5C,eAAe,GAAG2C,WAAW,CAAC,IAAD,CAAjC;;AAEA,MAAI3C,eAAe,CAACmB,OAAhB,KAA4B,IAAhC,EAAsC;AACpCnB,IAAAA,eAAe,CAACmB,OAAhB,GAA0B4B,2BAA2B,CAACtD,MAAD,CAArD;AACD;;AAED,MAAIuE,kBAAkB,GAAGlB,gBAAgB,CAAC,UAAUhD,MAAV,EAAkB;AAC1DkD,IAAAA,mBAAmB,CAAClD,MAAD,EAASC,SAAT,EAAoBC,eAApB,EAAqCC,eAArC,EAAsD/B,KAAtD,EAA6D,UAAU+F,WAAV,EAAuB;AACrGjE,MAAAA,eAAe,CAACmB,OAAhB,GAA0B8C,WAAW,CAACjE,eAAe,CAACmB,OAAjB,CAArC;;AAEA,UAAI0C,YAAY,CAAC1C,OAAjB,EAA0B;AACxB4C,QAAAA,UAAU,CAACvB,eAAD,CAAV;AACD;AACF,KANkB,EAMhBpC,qBANgB,EAMOC,aANP,CAAnB;AAOD,GARwC,EAQtC,CAACJ,eAAD,CARsC,CAAzC;AASA,MAAIiE,sBAAsB,GAAGpB,gBAAgB,CAAC,YAAY;AACxD,QAAIxC,iBAAiB,GAAGP,SAAS,CAACoB,OAAV,CAAkBC,UAA1C;AACA,QAAIZ,cAAc,GAAGR,eAAe,CAACmB,OAAhB,CAAwBb,iBAAxB,CAArB;;AAEA,QAAIE,cAAJ,EAAoB;AAClBwD,MAAAA,kBAAkB,CAAC,aAAD,CAAlB;AACD;AACF,GAP4C,EAO1C,CAACA,kBAAD,CAP0C,CAA7C;AAQAnB,EAAAA,cAAc,CAAC,YAAY;AACzB,QAAIiB,SAAS,CAAC3C,OAAd,EAAuB;AACrB2C,MAAAA,SAAS,CAAC3C,OAAV,GAAoB,KAApB;AACD,KAFD,MAEO;AACLnB,MAAAA,eAAe,CAACmB,OAAhB,GAA0B,EAA1B;AACA4C,MAAAA,UAAU,CAACvB,eAAD,CAAV;AACD;;AAED,QAAIvD,cAAc,KAAK,IAAvB,EAA6B;AAC3B+E,MAAAA,kBAAkB,CAAC,UAAD,CAAlB;AACD;AACF,GAXa,EAWXf,IAXW,CAAd;AAYAJ,EAAAA,cAAc,CAAC,YAAY;AACzB,QAAIU,UAAU,IAAI,CAACvD,eAAe,CAACmB,OAAhB,CAAwBC,UAAxB,CAAnB,EAAwD;AACtD4C,MAAAA,kBAAkB,CAAC,cAAD,CAAlB;AACD;AACF,GAJa,EAIX,CAAC5C,UAAD,CAJW,CAAd;AAKAyB,EAAAA,cAAc,CAAC,YAAY;AACzB,QAAIU,UAAU,IAAI,CAACvD,eAAe,CAACmB,OAAhB,CAAwB,EAAxB,CAAf,IAA8CkC,qBAAlD,EAAyE;AACvEW,MAAAA,kBAAkB,CAAC,aAAD,CAAlB;AACD;AACF,GAJa,EAIX,CAACT,UAAD,CAJW,CAAd;AAKA,MAAI/C,cAAc,GAAGR,eAAe,CAACmB,OAAhB,CAAwBC,UAAxB,KAAuC5B,eAAe,CAACC,MAAD,CAA3E;AACA,SAAO;AACLyE,IAAAA,sBAAsB,EAAEA,sBADnB;AAELN,IAAAA,cAAc,EAAEA,cAFX;AAGLH,IAAAA,YAAY,EAAEA,YAHT;AAILnE,IAAAA,SAAS,EAAEkB,cAAc,CAAClB,SAJrB;AAKLD,IAAAA,WAAW,EAAEmB,cAAc,CAACnB,WALvB;AAMLP,IAAAA,OAAO,EAAE0B,cAAc,CAAC1B;AANnB,GAAP;AAQD,CA1EM;AA2EP,OAAO,IAAIqF,oBAAoB,GAAG,SAASA,oBAAT,CAA8B1E,MAA9B,EAAsC;AACtE,MAAIwD,IAAI,GAAGV,SAAS,CAACW,MAAV,GAAmB,CAAnB,IAAwBX,SAAS,CAAC,CAAD,CAAT,KAAiBY,SAAzC,GAAqDZ,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;AACA,SAAOG,wBAAwB,CAAC1E,MAAD,EAASF,QAAT,EAAmBC,SAAnB,EAA8BE,WAA9B,EAA2CM,gBAA3C,EAA6DQ,sBAA7D,EAAqFW,cAArF,EAAqGD,MAArG,EAA6GwD,IAA7G,CAA/B;AACD,CAHM","sourcesContent":["import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _toPropertyKey from \"@babel/runtime/helpers/toPropertyKey\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport sleep from 'sleep-promise';\nimport useIsMountedRef from 'use-is-mounted-ref';\nimport { defaultShouldLoadMore } from './defaultShouldLoadMore';\nimport { defaultReduceOptions } from './defaultReduceOptions';\nvar errorText = '[react-select-async-paginate] response of \"loadOptions\" should be an object with \"options\" prop, which contains array of options.';\nexport var validateResponse = function validateResponse(console, response) {\n  if (!response) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n\n  if (!Array.isArray(response.options)) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n};\nexport var getInitialOptionsCache = function getInitialOptionsCache(_ref) {\n  var options = _ref.options,\n      defaultOptions = _ref.defaultOptions,\n      additional = _ref.additional,\n      defaultAdditional = _ref.defaultAdditional;\n  var initialOptions = defaultOptions === true ? null : defaultOptions instanceof Array ? defaultOptions : options;\n\n  if (initialOptions) {\n    return {\n      '': {\n        isFirstLoad: false,\n        isLoading: false,\n        options: initialOptions,\n        hasMore: true,\n        additional: defaultAdditional || additional\n      }\n    };\n  }\n\n  return {};\n};\nexport var getInitialCache = function getInitialCache(params) {\n  return {\n    isFirstLoad: true,\n    options: [],\n    hasMore: true,\n    isLoading: false,\n    additional: params.additional\n  };\n};\nexport var requestOptions = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(caller, paramsRef, optionsCacheRef, debounceTimeout, sleepParam, setOptionsCache, validateResponseParam, reduceOptions) {\n    var currentInputValue, isCacheEmpty, currentOptions, newInputValue, response, hasError, loadOptions, _response, options, hasMore, newAdditional;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            currentInputValue = paramsRef.current.inputValue;\n            isCacheEmpty = !optionsCacheRef.current[currentInputValue];\n            currentOptions = isCacheEmpty ? getInitialCache(paramsRef.current) : optionsCacheRef.current[currentInputValue];\n\n            if (!(currentOptions.isLoading || !currentOptions.hasMore)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 5:\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: true\n              })));\n            });\n\n            if (!(debounceTimeout > 0 && caller === 'input-change')) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 9;\n            return sleepParam(debounceTimeout);\n\n          case 9:\n            newInputValue = paramsRef.current.inputValue;\n\n            if (!(currentInputValue !== newInputValue)) {\n              _context.next = 13;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              if (isCacheEmpty) {\n                var itemForDelete = prevOptionsCache[currentInputValue],\n                    restCache = _objectWithoutProperties(prevOptionsCache, [currentInputValue].map(_toPropertyKey));\n\n                return restCache;\n              }\n\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 13:\n            _context.prev = 13;\n            loadOptions = paramsRef.current.loadOptions;\n            _context.next = 17;\n            return loadOptions(currentInputValue, currentOptions.options, currentOptions.additional);\n\n          case 17:\n            response = _context.sent;\n            hasError = false;\n            _context.next = 24;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](13);\n            hasError = true;\n\n          case 24:\n            if (!hasError) {\n              _context.next = 27;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 27:\n            validateResponseParam(console, response);\n            _response = response, options = _response.options, hasMore = _response.hasMore; // eslint-disable-next-line no-prototype-builtins\n\n            newAdditional = response.hasOwnProperty('additional') ? response.additional : currentOptions.additional;\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                options: reduceOptions(currentOptions.options, options, newAdditional),\n                hasMore: !!hasMore,\n                isLoading: false,\n                isFirstLoad: false,\n                additional: newAdditional\n              })));\n            });\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[13, 21]]);\n  }));\n\n  return function requestOptions(_x, _x2, _x3, _x4, _x5, _x6, _x7, _x8) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var increaseStateId = function increaseStateId(prevStateId) {\n  return prevStateId + 1;\n};\nexport var useAsyncPaginateBasePure = function useAsyncPaginateBasePure(useRefParam, useStateParam, useEffectParam, useCallbackParam, validateResponseParam, getInitialOptionsCacheParam, requestOptionsParam, params) {\n  var deps = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : [];\n  var defaultOptions = params.defaultOptions,\n      _params$loadOptionsOn = params.loadOptionsOnMenuOpen,\n      loadOptionsOnMenuOpen = _params$loadOptionsOn === void 0 ? true : _params$loadOptionsOn,\n      _params$debounceTimeo = params.debounceTimeout,\n      debounceTimeout = _params$debounceTimeo === void 0 ? 0 : _params$debounceTimeo,\n      inputValue = params.inputValue,\n      menuIsOpen = params.menuIsOpen,\n      _params$filterOption = params.filterOption,\n      filterOption = _params$filterOption === void 0 ? null : _params$filterOption,\n      _params$reduceOptions = params.reduceOptions,\n      reduceOptions = _params$reduceOptions === void 0 ? defaultReduceOptions : _params$reduceOptions,\n      _params$shouldLoadMor = params.shouldLoadMore,\n      shouldLoadMore = _params$shouldLoadMor === void 0 ? defaultShouldLoadMore : _params$shouldLoadMor;\n  var isMountedRef = useIsMountedRef();\n  var isInitRef = useRefParam(true);\n  var paramsRef = useRefParam(params);\n  paramsRef.current = params;\n  var setStateId = useStateParam(0)[1];\n  var optionsCacheRef = useRefParam(null);\n\n  if (optionsCacheRef.current === null) {\n    optionsCacheRef.current = getInitialOptionsCacheParam(params);\n  }\n\n  var callRequestOptions = useCallbackParam(function (caller) {\n    requestOptionsParam(caller, paramsRef, optionsCacheRef, debounceTimeout, sleep, function (reduceState) {\n      optionsCacheRef.current = reduceState(optionsCacheRef.current);\n\n      if (isMountedRef.current) {\n        setStateId(increaseStateId);\n      }\n    }, validateResponseParam, reduceOptions);\n  }, [debounceTimeout]);\n  var handleScrolledToBottom = useCallbackParam(function () {\n    var currentInputValue = paramsRef.current.inputValue;\n    var currentOptions = optionsCacheRef.current[currentInputValue];\n\n    if (currentOptions) {\n      callRequestOptions('menu-scroll');\n    }\n  }, [callRequestOptions]);\n  useEffectParam(function () {\n    if (isInitRef.current) {\n      isInitRef.current = false;\n    } else {\n      optionsCacheRef.current = {};\n      setStateId(increaseStateId);\n    }\n\n    if (defaultOptions === true) {\n      callRequestOptions('autoload');\n    }\n  }, deps);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[inputValue]) {\n      callRequestOptions('input-change');\n    }\n  }, [inputValue]);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[''] && loadOptionsOnMenuOpen) {\n      callRequestOptions('menu-toggle');\n    }\n  }, [menuIsOpen]);\n  var currentOptions = optionsCacheRef.current[inputValue] || getInitialCache(params);\n  return {\n    handleScrolledToBottom: handleScrolledToBottom,\n    shouldLoadMore: shouldLoadMore,\n    filterOption: filterOption,\n    isLoading: currentOptions.isLoading,\n    isFirstLoad: currentOptions.isFirstLoad,\n    options: currentOptions.options\n  };\n};\nexport var useAsyncPaginateBase = function useAsyncPaginateBase(params) {\n  var deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return useAsyncPaginateBasePure(useRef, useState, useEffect, useCallback, validateResponse, getInitialOptionsCache, requestOptions, params, deps);\n};"]},"metadata":{},"sourceType":"module"}